$(document).ready(function(){Laravel.initialize(),Form.csrf(),Form.observer(),$("body").on("submit","form.ajax-form",function(){return Form.submit($(this))})});var Collections=function(){var e={};return e.addField=function(e){$.post(BASEURL+"/collections/addField",{fieldNumber:e}).done(function(e){$(".form-fields").append(e.view)})},e}();$("form.collection-form").on("click",".add-field",function(){var e=$(this).attr("data-field-number");$(this).attr("data-field-number",parseInt(e)+1),Collections.addField(e)}),$("form.collection-form").on("change","select",function(){var e=$(this).parent().parent().find(".collection-options");$(this).hasClass("collection-type")&&"select"==$(this).val()?e.fadeIn():e.fadeOut()});var Form=function(){var e={},t={};return t.ajaxSettings={beforeSubmit:function(e,r,n){r.find("input, select, textarea").removeClass("form-error"),r.find("input[type='submit']").prop("disabled",!0),r.find(".form-status").show().removeClass("form-error").removeClass("form-success").addClass("form-sending").html(""),r.find(".form-message").html(""),"beforeSubmit"==t.callback.on&&t.callback.callback({arr:e,$form:r,options:n})},success:function(e,r,n,o){o.find(".form-status").removeClass("form-sending").addClass("form-success"),setTimeout(function(){$(".form-success").slideUp("slow",function(){$(this).html("").removeClass("form-success")})},5e3),o.hasClass("form-clear")&&o.trigger("reset"),o.find("input[type='submit']").prop("disabled",!1),"success"==t.callback.on&&t.callback.callback({result:e,status:r,xhr:n,$form:o})},error:function(e,r,n,o){o.find(".form-status").removeClass("form-sending").addClass("form-error"),e.responseJSON.errors&&$.each(e.responseJSON.errors,function(e,t){if(-1!==e.search(".")){var e=e.split(".");$.each(e,function(t,r){0==t?e=r:e+="["+r+"]"})}var r=o.find("input[name='"+e+"'], textarea[name='"+e+"'], select[name='"+e+"']");r.addClass("form-error").siblings(".form-message").addClass("error").text(t)}),e.responseJSON.errorMessage&&o.find(".form-status").removeClass("form-error").text(e.responseJSON.errorMessage),o.find("input[type='submit']").prop("disabled",!1),"error"==t.callback.on&&t.callback.callback({result:e,status:r,xhr:n,$form:o})}},e.submit=function(e,r){return t.callback=r||"undefined",e.ajaxSubmit(t.ajaxSettings),!1},e.observer=function(){$(document).ajaxComplete(function(e,t){if("undefined"===t.responseText)return!1;var r=JSON.parse(t.responseText);r.redirect&&r.timeout?setTimeout(function(){window.location=r.redirect},r.timeout):r.redirect&&(window.location=r.redirect)})},e.csrf=function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")},cache:!0})},e}(),Laravel={initialize:function(){this.methodLinks=$("a[data-method]"),this.registerEvents()},registerEvents:function(){this.methodLinks.on("click",this.handleMethod)},handleMethod:function(e){var t,r=$(this),n=r.data("method").toUpperCase();if(-1!==$.inArray(n,["PUT","DELETE"])){if(r.data("confirm")&&!Laravel.verifyConfirm(r))return!1;t=Laravel.createForm(r),t.submit(),e.preventDefault()}},verifyConfirm:function(e){return confirm(e.data("confirm"))},createForm:function(e){var t=$("<form>",{method:"POST",action:e.attr("href")}),r=$("<input>",{type:"hidden",name:"_token",value:$('meta[name="_token"]').attr("content")}),n=$("<input>",{name:"_method",type:"hidden",value:e.data("method")});return t.append(r,n).appendTo("body")}};