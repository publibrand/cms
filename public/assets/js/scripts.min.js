$(document).ready(function(){Laravel.initialize(),Form.csrf(),Form.observer(),$("body").on("submit","form.ajax-form",function(){return Form.submit($(this))})});var Collections=function(){var e={};return e.addField=function(e){$.post(BASEURL+"/collections/addField",{fieldNumber:e}).done(function(e){$(".form-fields").append(e.view)})},e.removeField=function(e){e.remove()},e.search=function(e){$.post(BASEURL+"/collections/search",{query:e}).done(function(e){$collections=$(".dashboard-collections"),$collections.children().remove().end().append(e.view)})},e}();$("form.collection-form").on("click",".add-field",function(){var e=$(this).attr("data-field-number");$(this).attr("data-field-number",parseInt(e)+1),Collections.addField(e)}),$("form.collection-form").on("click",".remove-field",function(){$formField=$(this).parent().parent(),Collections.removeField($formField)}),$("form.collection-form").on("keyup","#name",function(){Form.slug($(this).val(),$("#slug"))}),$("form.collection-form").on("keyup",".field-name",function(){var e=$(this).parent().parent().find(".field-label");Form.slug($(this).val(),e,"_")}),$("form.collection-form").on("change","select",function(){var e=$(this).parent().parent().find(".collection-options");$(this).hasClass("collection-type")&&"select"==$(this).val()?e.fadeIn():(e.fadeOut(),e.find("input").val(""))}),$("form.search-form").on("submit",function(e){e.preventDefault(),Collections.search($(this).val())}),$("form.search-form").on("keyup","input[name='query']",function(){Collections.search($(this).val())});var Form=function(){var e={},t={};return t.ajaxSettings={beforeSubmit:function(e,o,r){o.find("input, select, textarea").removeClass("form-error"),o.find("input[type='submit']").prop("disabled",!0),o.find(".form-status").show().removeClass("form-error").removeClass("form-success").addClass("form-sending").html(""),o.find(".form-message").html(""),"beforeSubmit"==t.callback.on&&t.callback.callback({arr:e,$form:o,options:r})},success:function(e,o,r,n){n.find(".form-status").removeClass("form-sending").addClass("form-success"),setTimeout(function(){$(".form-success").slideUp("slow",function(){$(this).html("").removeClass("form-success")})},5e3),n.hasClass("form-clear")&&n.trigger("reset"),n.find("input[type='submit']").prop("disabled",!1),"success"==t.callback.on&&t.callback.callback({result:e,status:o,xhr:r,$form:n})},error:function(e,o,r,n){n.find(".form-status").removeClass("form-sending").addClass("form-error"),e.responseJSON.errors&&$.each(e.responseJSON.errors,function(e,t){if(-1!==e.search(".")){var e=e.split(".");$.each(e,function(t,o){0==t?e=o:e+="["+o+"]"})}var o=n.find("input[name='"+e+"'], textarea[name='"+e+"'], select[name='"+e+"']");o.addClass("form-error").siblings(".form-message").addClass("error").text(t)}),e.responseJSON.errorMessage&&n.find(".form-status").removeClass("form-error").text(e.responseJSON.errorMessage),n.find("input[type='submit']").prop("disabled",!1),"error"==t.callback.on&&t.callback.callback({result:e,status:o,xhr:r,$form:n})}},e.submit=function(e,o){return t.callback=o||"undefined",e.ajaxSubmit(t.ajaxSettings),!1},e.observer=function(){$(document).ajaxComplete(function(e,t){if("undefined"===t.responseText)return!1;var o=JSON.parse(t.responseText);o.redirect&&o.timeout?setTimeout(function(){window.location=o.redirect},o.timeout):o.redirect&&(window.location=o.redirect)})},e.slug=function(e,t,o){o=o||"-",t.val(getSlug(e,o))},e.csrf=function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")},cache:!0})},e}(),Laravel={initialize:function(){this.methodLinks=$("a[data-method]"),this.registerEvents()},registerEvents:function(){this.methodLinks.on("click",this.handleMethod)},handleMethod:function(e){var t,o=$(this),r=o.data("method").toUpperCase();if(-1!==$.inArray(r,["PUT","DELETE"])){if(o.data("confirm")&&!Laravel.verifyConfirm(o))return!1;t=Laravel.createForm(o),t.submit(),e.preventDefault()}},verifyConfirm:function(e){return confirm(e.data("confirm"))},createForm:function(e){var t=$("<form>",{method:"POST",action:e.attr("href")}),o=$("<input>",{type:"hidden",name:"_token",value:$('meta[name="_token"]').attr("content")}),r=$("<input>",{name:"_method",type:"hidden",value:e.data("method")});return t.append(o,r).appendTo("body")}};